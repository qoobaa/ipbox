<div class="row my-3">
  <div class="col">
    <h2>
      Importuj wpisy
    </h2>
  </div>
</div>

<p>
  Proszę wywołać następujące polecenie wewnątrz repozytorium importowanego projektu:
</p>

<code>
git log --author kuba@kubakuzma.com --no-merges --after='2019-01-01 00:00:00' --before='2019-12-31 23:59:59' --pretty='format:%H %aI %s' | curl -X POST <%= import_project_url(@project) %> --data-binary @-
</code>

<div class="my-3" data-controller="imports" data-imports-project-id="<%= @project.id %>">
  <div data-target="imports.awaiting">
    <%= button_tag class: "btn btn-success", disabled: true do %>
      <span class="spinner-border spinner-border-sm" role="status"></span>
      Oczekiwanie na wpisy…
    <% end %>
  </div>

  <div data-target="imports.complete" class="d-none">
    <p>
      Pomyślnie zaimportowano <span data-target="imports.entries">0</span> wpisów.
    </p>
    <p>
      <%= link_to "Przeglądaj wpisy", entries_path(q: {project_id_eq: @project.id}), class: "btn btn-success" %>
    </p>
  </div>
</div>

<p>
  lub
</p>

<%= form_for @project, url: upload_project_path(@project), html: {method: :put} do |form| %>
  <div class="form-group">
    <%= form.label :file, "Załaduj kalendarz" %>
    <%= form.file_field :file, class: "form-control-file" %>
  </div>

  <div class="form-group">
    <%= form.submit "Załaduj", class: "btn btn-success" %>
  </div>
<% end %>
